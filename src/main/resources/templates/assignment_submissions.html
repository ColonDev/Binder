<!-- src/main/resources/templates/assignment_submissions.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="english">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Assignment Submissions - Binder</title>

    <link rel="stylesheet" th:href="@{/css/base.css}" />
    <link rel="stylesheet" th:href="@{/css/classroom.css(v=${#dates.createNow().time})}" href="/css/classroom.css" />
</head>

<body>
<div class="app">
    <div th:replace="fragments/sidebar :: sidebar('')"></div>

    <main class="main">
        <div class="paper">
            <div style="display:flex;justify-content:space-between;align-items:flex-end;gap:16px;flex-wrap:wrap;">
                <div>
                    <h1 class="page-title" style="margin-bottom:6px;">Submissions</h1>
                    <div class="help">
                        <span th:if="${assignmentTitle != null}" th:text="${assignmentTitle}">Assignment title</span>
                        <span th:if="${assignmentTitle == null}">
                            Assignment:
                            <span th:text="${assignmentId}">assignment-id</span>
                        </span>
                    </div>
                </div>

                <a class="btn" th:href="@{/classrooms/{id}(id=${classroomId})}">Back to classroom</a>
            </div>

            <div class="empty-msg" th:if="${submissions == null || #lists.isEmpty(submissions)}" style="margin-top:18px;">
                No submissions yet.
            </div>

            <div th:if="${submissions != null && !#lists.isEmpty(submissions)}" style="margin-top:18px;">
                <table class="table" style="width:100%;border-collapse:collapse;">
                    <thead>
                    <tr>
                        <th style="text-align:left;padding:10px 8px;">Student</th>
                        <th style="text-align:left;padding:10px 8px;">Email</th>
                        <th style="text-align:left;padding:10px 8px;">Submitted</th>
                        <th style="text-align:left;padding:10px 8px;">Attachment</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="s : ${submissions}">
                        <td style="padding:10px 8px;" th:text="${s.studentName} ?: '—'">Student Name</td>
                        <td style="padding:10px 8px;" th:text="${s.studentEmail} ?: '—'">student@email.com</td>

                        <!-- Supports either submissionTime or submittedAt depending on your DTO -->
                        <td style="padding:10px 8px;"
                            th:text="${s.submissionTime != null} ? ${#temporals.format(s.submissionTime, 'yyyy-MM-dd HH:mm')} :
                                    (${s.submittedAt != null} ? ${#temporals.format(s.submittedAt, 'yyyy-MM-dd HH:mm')} : '—')">
                            2026-01-07 12:00
                        </td>

                        <td style="padding:10px 8px;">
                            <span th:if="${s.attachmentId == null}">—</span>

                            <a th:if="${s.attachmentId != null}"
                               class="attachment-link"
                               th:href="@{/attachments/{id}(id=${s.attachmentId})}"
                               th:text="${s.attachmentFilename} ?: 'Download'">
                                Download
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <div class="help" style="margin-top:10px;"
                     th:text="'Total submissions: ' + ${#lists.size(submissions)}">
                    Total submissions: 0
                </div>
            </div>
        </div>
    </main>
</div>
</body>
</html>
